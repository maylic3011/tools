<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cosmic Self - Find Your Place in the Cosmos</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #c9d1d9;
            --background-color: #0d1117;
            --card-background: #161b22;
            --border-color: #30363d;
            --accent-color: #58a6ff;
            --accent-hover: #79c0ff;
            --font-display: 'Orbitron', sans-serif;
            --font-body: 'Roboto', sans-serif;
            --box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: var(--font-body);
            background-color: var(--background-color);
            color: var(--primary-color);
            line-height: 1.6;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            background-image: url('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40"%3E%3Cg fill-rule="evenodd"%3E%3Cg fill="%23161b22" fill-opacity="0.4"%3E%3Cpath d="M0 38.59l2.83-2.83 1.41 1.41L1.41 40H0v-1.41zM0 1.4l2.83 2.83 1.41-1.41L1.41 0H0v1.41zM38.59 40l-2.83-2.83 1.41-1.41L40 38.59V40h-1.41zM40 1.41l-2.83 2.83-1.41-1.41L38.59 0H40v1.41zM20 18.6l2.83-2.83 1.41 1.41L21.41 20l2.83 2.83-1.41 1.41L20 21.41l-2.83 2.83-1.41-1.41L18.59 20l-2.83-2.83 1.41-1.41L20 18.59z"/%3E%3C/g%3E%3C/g%3E%3C/svg%3E');
        }

        .container {
            width: 100%;
            max-width: 800px;
            text-align: center;
        }

        header h1 {
            font-family: var(--font-display);
            color: white;
            font-size: 3rem;
            letter-spacing: 2px;
            text-shadow: 0 0 10px var(--accent-color);
        }

        header .tagline {
            font-size: 1.25rem;
            color: var(--primary-color);
            margin-bottom: 40px;
            font-weight: 300;
        }

        .input-form {
            background: var(--card-background);
            padding: 30px 40px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            box-shadow: var(--box-shadow);
            margin-bottom: 40px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .form-group { display: flex; flex-direction: column; text-align: left; }
        .form-group label { margin-bottom: 8px; font-weight: 700; }
        .form-group input, .form-group select {
            background-color: var(--background-color);
            border: 1px solid var(--border-color);
            color: var(--primary-color);
            padding: 12px;
            border-radius: 6px;
            font-size: 1rem;
            width: 100%;
            font-family: var(--font-body);
        }
        
        #discover-button {
            grid-column: 1 / -1;
            margin-top: 10px;
            background-color: var(--accent-color);
            color: #fff;
            border: none;
            padding: 14px 30px;
            border-radius: 6px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }
        #discover-button:hover { background-color: var(--accent-hover); transform: translateY(-2px); }

        .results-card {
            background: var(--card-background);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            box-shadow: var(--box-shadow);
            text-align: left;
            width: 100%;
            display: none; 
            animation: fadeIn 0.8s ease-in-out;
            margin-top: 30px;
            overflow: hidden;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
        
        .result-header { padding: 30px; background: linear-gradient(180deg, rgba(30, 36, 45, 0.8), rgba(30, 36, 45, 1)); }
        #celestial-name { font-family: var(--font-display); color: white; font-size: 2.2rem; margin-bottom: 10px; }
        #match-description { font-size: 1.1rem; color: var(--primary-color); white-space: pre-wrap; }
        
        /* New Motto Section */
        #motto-section {
            padding: 20px 30px;
            background: var(--background-color);
            border-top: 1px solid var(--border-color);
            border-bottom: 1px solid var(--border-color);
            text-align: center;
        }
        #cosmic-motto {
            font-family: var(--font-display);
            font-size: 1.2rem;
            color: var(--accent-color);
            font-style: italic;
        }

        .apod-section { padding: 30px; }
        .apod-section h3 { color: var(--accent-color); font-family: var(--font-display); margin-bottom: 15px; font-size: 1.5rem; border-bottom: 2px solid var(--border-color); padding-bottom: 10px; }
        #apod-image { width: 100%; border-radius: 8px; margin-bottom: 20px; background-color: var(--background-color); }
        #apod-title { font-weight: 700; font-size: 1.2rem; margin-bottom: 10px; }
        #apod-explanation { font-weight: 300; font-size: 0.95rem; line-height: 1.7; text-align: justify; }

        #loading, #error-message {
            display: none;
            margin-top: 20px;
            font-size: 1.1rem;
            color: var(--primary-color);
            background-color: var(--card-background);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>Cosmic Self</h1>
            <p class="tagline">Discover Your Celestial Twin</p>
        </header>

        <div class="input-form">
            <div class="form-group"><label for="user-name">Your Name</label><input type="text" id="user-name" placeholder="e.g., Alex"></div>
            <div class="form-group"><label for="birth-year">Your Birth Year</label><input type="number" id="birth-year" placeholder="e.g., 1995" min="1996"></div>
            <div class="form-group"><label for="user-gender">Your Gender</label><select id="user-gender"><option value="unspecified">Select Gender</option><option value="male">Male</option><option value="female">Female</option><option value="other">Other / Prefer not to say</option></select></div>
            <div class="form-group"><label for="personality">Your Personality</label><select id="personality"><option value="adventurer">The Adventurer</option><option value="thinker">The Thinker</option><option value="artist">The Artist</option><option value="leader">The Leader</option><option value="nurturer">The Nurturer</option><option value="protector">The Protector</option><option value="mystic">The Mystic</option><option value="innovator">The Innovator</option><option value="harmonizer">The Harmonizer</option><option value="communicator">The Communicator</option></select></div>
            <button id="discover-button">Discover</button>
        </div>

        <div id="loading">Contacting Star Command... Retrieving cosmic data...</div>
        <div id="error-message"></div>

        <div class="results-card" id="results-card">
            <div class="result-header">
                <h2 id="celestial-name"></h2>
                <p id="match-description"></p>
            </div>
            <div id="motto-section">
                <p id="cosmic-motto"></p>
            </div>
            <div class="apod-section">
                <h3>Your Unique Cosmic Snapshot</h3>
                <img id="apod-image" src="" alt="Astronomy Picture of the Day">
                <p id="apod-title"></p>
                <p id="apod-explanation"></p>
            </div>
        </div>
    </div>

    <script>
        const NASA_API_KEY = 'Mdnv8oxTNwL3DYaB6Be59oVtc8TgTEf9bMlAOw0V';

        // --- Celestial Matching Data with EXPANDED descriptions ---
        const celestialMatches = {
            adventurer: {
                name: "Voyager 1",
                description: `You are an explorer at heart, constantly pushing boundaries and venturing into the unknown. You are not content with the familiar and feel a profound pull toward the next frontier.

                **Your Cosmic Strengths:** Resilience, boundless curiosity, and a pioneering spirit. Like Voyager, you are built to last and to keep sending back discoveries from the edge.
                **Your Cosmic Quirk:** You can sometimes feel distant or disconnected from your "home base," as your focus is always on what lies ahead.`,
                motto: "My destination is the next discovery."
            },
            thinker: {
                name: "James Webb Space Telescope",
                description: `You are a deep thinker, capable of seeing things others miss. You look past the surface to understand the fundamental structures of the universe, whether in science, relationships, or art.

                **Your Cosmic Strengths:** Incredible perception, analytical prowess, and patience. You can sift through cosmic noise to find clarity and reveal truths that were hidden in plain sight.
                **Your Cosmic Quirk:** You may sometimes get lost in abstract thought, preferring the elegance of ideas to the messiness of the immediate world.`,
                motto: "Look closer. The truth is in the details."
            },
            artist: {
                name: "The Planet Saturn",
                description: `You are a being of immense beauty, structure, and style. Like Saturn's magnificent rings, you have a unique and captivating presence that is both ordered and breathtakingly creative.

                **Your Cosmic Strengths:** A profound sense of aesthetics, discipline, and a majestic presence. You inspire awe by creating beauty and structure in the world around you.
                **Your Cosmic Quirk:** Your high standards can lead to perfectionism, and you might feel "ringed in" by your own rules and expectations at times.`,
                motto: "Beauty is structure, and I am the architect."
            },
            leader: {
                name: "The Sun",
                description: `You are a natural center of gravity. Your energy, warmth, and vision radiate outward, bringing others into your orbit and providing them with light and direction.

                **Your Cosmic Strengths:** Charisma, boundless energy, and an ability to inspire and unite. You are a source of vitality and confidence for your entire "solar system."
                **Your Cosmic Quirk:** The pressure of being the center can be immense, and you must be careful not to unintentionally outshine those you mean to lead.`,
                motto: "I create the gravity that brings us together."
            },
            nurturer: {
                name: "The Moon",
                description: `You are a reliable, guiding force, reflecting light into the darkest of times. Your presence is a source of comfort and stability, and you are deeply connected to the natural rhythms and cycles of life.

                **Your Cosmic Strengths:** Empathy, intuition, and steadfast reliability. You have a powerful, quiet influence that helps others navigate their own emotional tides.
                **Your Cosmic Quirk:** Because you reflect the energy around you, you must be careful to protect your own energy and not become drained by the needs of others.`,
                motto: "I find my strength in the tides I guide."
            },
            protector: {
                name: "The Planet Jupiter",
                description: `You are a powerful, benevolent guardian. Like Jupiter's immense gravity that shields the inner planets from cosmic debris, you possess a formidable strength that you use to defend your loved ones and your ideals.

                **Your Cosmic Strengths:** Dependability, immense generosity, and a stabilizing presence. You are the rock that others can rely on when cosmic storms arise.
                **Your Cosmic Quirk:** Your protective nature can sometimes be overbearing, and your "Great Red Spot" might show when you feel your protective duties are threatened.`,
                motto: "My presence is your shield."
            },
            mystic: {
                name: "The Planet Neptune",
                description: `You are attuned to the unseen currents of the universe. Your world is one of dreams, intuition, and profound emotional depth. You understand that the greatest truths often lie beyond what is visible.

                **Your Cosmic Strengths:** Deep compassion, powerful imagination, and a strong connection to the spiritual or subconscious. You navigate a world of feeling and symbolism with ease.
                **Your Cosmic Quirk:** The line between dream and reality can sometimes blur, and you may find it challenging to stay grounded in the mundane world.`,
                motto: "The deepest truths are found beyond the visible."
            },
            innovator: {
                name: "The Mars Rover Perseverance",
                description: `You are a pioneer of what's possible, driven by logic, data, and an unshakeable will to solve the next great problem. You are designed to explore new worlds and bring back groundbreaking knowledge.

                **Your Cosmic Strengths:** Resourcefulness, methodical determination, and a forward-thinking mindset. You thrive on challenges and are not afraid to tackle alien environments.
                **Your Cosmic Quirk:** Your intense focus on the "mission" can sometimes make you seem detached or overly analytical, prioritizing data over feeling.`,
                motto: "The only limit is the next problem to solve."
            },
            harmonizer: {
                name: "The Planet Earth",
                description: `You are a creator of ecosystems. You have a unique and vital talent for bringing different elements together to create a balanced, thriving, and life-sustaining whole, whether in a family, a team, or a community.

                **Your Cosmic Strengths:** A nurturing spirit, a grounding presence, and an innate ability to foster growth and connection. You create the environment where others can be their best selves.
                **Your Cosmic Quirk:** You may feel the weight of supporting your "ecosystem" and can be sensitive to disharmony or imbalance within it.`,
                motto: "I am the ground where all things grow."
            },
            communicator: {
                name: "The Planet Mercury",
                description: `You are a master of connection and exchange. Like the swift messenger planet, you move quickly, think on your feet, and excel at translating and transmitting ideas between people and groups.

                **Your Cosmic Strengths:** Articulate, adaptable, and incredibly quick-witted. You are the network that keeps information flowing and ideas moving.
                **Your Cosmic Quirk:** Your speed can sometimes be dizzying for others, and you might be prone to favoring quick wit over deep, prolonged analysis.`,
                motto: "An idea shared is an idea amplified."
            }
        };

        const userNameInput = document.getElementById('user-name');
        const birthYearInput = document.getElementById('birth-year');
        const userGenderSelect = document.getElementById('user-gender');
        const personalitySelect = document.getElementById('personality');
        const discoverButton = document.getElementById('discover-button');
        const resultsCard = document.getElementById('results-card');
        const loadingDiv = document.getElementById('loading');
        const errorMessageDiv = document.getElementById('error-message');
        
        const celestialNameEl = document.getElementById('celestial-name');
        const matchDescriptionEl = document.getElementById('match-description');
        const cosmicMottoEl = document.getElementById('cosmic-motto');
        const apodImageEl = document.getElementById('apod-image');
        const apodTitleEl = document.getElementById('apod-title');
        const apodExplanationEl = document.getElementById('apod-explanation');

        discoverButton.addEventListener('click', handleDiscover);

        async function handleDiscover() {
            const userName = userNameInput.value.trim();
            const birthYear = birthYearInput.value;
            const userGender = userGenderSelect.value;
            const personality = personalitySelect.value;
            const currentYear = new Date().getFullYear();

            if (!userName) { showError("Please enter your name."); return; }
            if (!birthYear || birthYear < 1996 || birthYear > currentYear) { showError(`Please enter a valid birth year between 1996 and ${currentYear}.`); return; }

            resetUI();
            loadingDiv.style.display = 'block';

            let dateModifier = 0;
            if (userGender === 'male') { dateModifier = 1; }
            else if (userGender === 'female') { dateModifier = -1; }
            
            const apodYear = parseInt(birthYear) + 18 + dateModifier;
            const randomMonth = Math.floor(Math.random() * 12) + 1;
            const randomDay = Math.floor(Math.random() * 28) + 1;
            const apodDate = `${apodYear}-${String(randomMonth).padStart(2, '0')}-${String(randomDay).padStart(2, '0')}`;

            const match = celestialMatches[personality];

            try {
                const response = await fetch(`https://api.nasa.gov/planetary/apod?api_key=${NASA_API_KEY}&date=${apodDate}`);
                if (!response.ok) { throw new Error(`Failed to fetch cosmic data for ${apodDate}.`); }
                const data = await response.json();
                if (data.media_type !== 'image') { showError(`The cosmos sent back a video for your unique date! Please try again to get a different snapshot.`); return; }
                displayResults(userName, match, data);
            } catch (error) {
                console.error("NASA API Error:", error);
                showError("Could not connect to Star Command. There might be solar flares interfering with the signal. Please try again.");
            }
        }

        function displayResults(name, match, apodData) {
            loadingDiv.style.display = 'none';
            const capitalizedName = name.charAt(0).toUpperCase() + name.slice(1);

            celestialNameEl.textContent = `${capitalizedName}, your Cosmic Twin is ${match.name}`;
            matchDescriptionEl.textContent = match.description;
            cosmicMottoEl.textContent = `"${match.motto}"`;

            apodImageEl.src = apodData.url;
            apodImageEl.alt = apodData.title;
            apodTitleEl.textContent = `${apodData.title} (Cosmic Snapshot from ${apodData.date})`;
            apodExplanationEl.textContent = apodData.explanation;

            resultsCard.style.display = 'block';
        }

        function showError(message) {
            loadingDiv.style.display = 'none';
            errorMessageDiv.textContent = message;
            errorMessageDiv.style.display = 'block';
        }
        
        function resetUI() {
            resultsCard.style.display = 'none';
            errorMessageDiv.style.display = 'none';
        }
    </script>
</body>
</html>